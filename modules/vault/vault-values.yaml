global:
  tlsDisable: true

server:
  affinity: {}

  service:
    type: ClusterIP
    enabled: true
    port: 8200

  serviceAccount:
    create: true
    name: vault-server

  # Mount the PKCS#11 proxy library
  extraVolumes:
    - name: pkcs11-proxy-lib
      hostPath:
        path: /opt/pkcs11/libpkcs11-proxy.so
        type: File

  extraVolumeMounts:
    - name: pkcs11-proxy-lib
      mountPath: /usr/local/lib/libpkcs11-proxy.so
      subPath: libpkcs11-proxy.so

  ha:
    enabled: true
    replicas: 2

    # Config must be under ha, not under raft
    config: |
      ui = true

      listener "tcp" {
        address = "0.0.0.0:8200"
        cluster_address = "0.0.0.0:8201"
        tls_disable = 1
      }

      storage "raft" {
        path = "/vault/data"
      }

      service_registration "kubernetes" {}

    # Raft storage settings
    raft:
      enabled: true
      setNodeId: true
      storage:
        enabled: true
        size: 5Gi
        storageClass: standard
        accessMode: ReadWriteOnce
        mountPath: /vault/data

  ui:
    enabled: true

injector:
  enabled: false
